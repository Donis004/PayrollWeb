@model List<string>

@{
    ViewData["Title"] = "Mi Asistencia";
}

<div class="container mt-5">
    <h2 class="mb-4 text-success">Mi Asistencia</h2>


    <!-- Contenedor de búsqueda -->
    <div class="d-flex mb-3 row">
        <!-- Input para buscar por fecha -->
        <div class="col-12 col-md-6 mb-2 mb-md-0 pr-md-2">
            <label for="fechaBusqueda">Buscar por Fecha</label>
            <input type="date" class="form-control" id="fechaBusqueda"
                   min="2015-01-01"
                   max="@DateTime.Now.ToString("yyyy-MM-dd")" />
        </div>      
    </div>

    <a href="@Url.Action("AgregarAsistencia", "Asistencia")" class="btn btn-success mb-3">
        <i class="bi bi-plus-circle"></i> Registrar Asistencias
    </a>

    @if (Model != null && Model.Count > 0)
    {
        <div class="table-responsive">
            <table class="table table-bordered table-striped">
                <thead class="table-success">
                    <tr>
                        <th>Fecha</th>
                        <th>Hora de Entrada</th>
                        <th>Hora de Salida</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var registro in Model)
                    {
                        var datos = registro.Split('|');
                        <tr class="fecha-asistencia" data-fecha="@datos[0]">
                            <td>@datos[0]</td>
                            <td>@datos[1]</td>
                            <td>@datos[2]</td>
                        </tr>

                    }
                </tbody>
            </table>
        </div>
    }
    else
    {
        <div class="alert alert-info">No se encontraron registros de asistencia.</div>
    }
</div>


<script>
       document.getElementById("fechaBusqueda").addEventListener("change", function () {
        var fechaSeleccionada = this.value;
        var empleados = document.querySelectorAll(".fecha-asistencia");

        empleados.forEach(function (grupoFecha) {
            // Mostrar solo el grupo de asistencia que coincide con la fecha seleccionada
            if (grupoFecha.getAttribute("data-fecha") === fechaSeleccionada || fechaSeleccionada === "") {
                grupoFecha.style.display = "block";
            } else {
                grupoFecha.style.display = "none";
            }
        });

        // Limpiar el campo de búsqueda por empleado cuando se cambie la fecha
        document.getElementById("empleadoBusqueda").value = "";
        filtrarEmpleados(); // Aplicar filtro para empleado vacío cuando se cambia la fecha
    });

      document.getElementById("fechaBusqueda").addEventListener("change", function () {
        var fechaSeleccionada = this.value;
        var filas = document.querySelectorAll(".fecha-asistencia");

        filas.forEach(function (fila) {
            var fechaFila = fila.getAttribute("data-fecha");
            if (fechaSeleccionada === "" || fechaFila === fechaSeleccionada) {
                fila.style.display = "table-row";
            } else {
                fila.style.display = "none";
            }
        });
    });
</script>


                 